#!/bin/bash
# This file was generated from the README.md.
inotifywait --monitor --event close_write --format '%w%f' ebin | while read file; do
    case $file in
        *.beam)
            module_name=$(basename "$file" .beam)
            erlang_code="{lfe_watcher_reloader, list_to_atom(\"lfe_watcher_shell@\" ++ net_adm:localhost())} ! \"$module_name\""

            erl -noshell -sname lfe_watcher_inotify -eval "$erlang_code" -s init stop
            ;;
    esac
done &
lfe -sname lfe_watcher_shell -pa ebin